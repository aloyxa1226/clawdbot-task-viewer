## Bead Task

```

○ clawdbot-task-viewer-d5q · [US-002 BE] Add task dependency fields to Task model   [● P1 · OPEN]
Owner: admin · Type: task
Created: 2026-01-27 · Updated: 2026-01-27

DESCRIPTION
Add blocks and blockedBy fields to the Task data model and database schema.

ACCEPTANCE CRITERIA
Task model includes blocks and blockedBy fields. Database schema is updated accordingly. Typecheck passes

DEPENDS ON
  → ✓ clawdbot-task-viewer-xq0: [US-000] Project Setup - TypeScript, Express, React, PostgreSQL, Redis ● P0

BLOCKS
  ← ○ clawdbot-task-viewer-403: [US-002 FE] Visualize Task Dependencies in UI ● P1
```

## Instructions

# Beads Sub-Agent Instructions

You are executing a single bead task in an isolated git worktree.

---

## Your Task

The bead details and PRD context are provided above (or in the attached context file).

**Environment variables (if available):**
- `BEAD_ID` — The bead you're implementing
- `WORKTREE_PATH` — Your isolated working directory

---

## Execution Steps

### 1. Understand the Task
- Read the bead description and acceptance criteria carefully
- Review the PRD context for broader understanding
- If `retry_count > 0` in bead notes, check what failed previously

### 2. Plan Before Coding
- Identify files to create/modify
- Note dependencies on other code
- Consider edge cases from acceptance criteria

### 3. Implement
- Make minimal, focused changes
- Follow existing code patterns in the codebase
- Keep changes within scope of this bead only

### 4. Verify Acceptance Criteria

Check EVERY criterion explicitly:

```bash
# Typecheck (always required)
npm run typecheck || pnpm typecheck || yarn typecheck

# Lint
npm run lint || pnpm lint || yarn lint

# Tests
npm test || pnpm test || yarn test
```

For UI changes, document what to verify:
- Navigation path (e.g., "Go to /dashboard")
- Expected behavior (e.g., "Chart renders with data")
- Visual confirmation needed

### 5. Commit

```bash
git add -A
git commit -m "feat: [$BEAD_ID] - [Short description]"
```

### 6. Write Progress Log

Create `logs/bead-$BEAD_ID-progress.md`:

```markdown
## [BEAD_ID] - [Date]

### Implemented
- [What was done]

### Files Changed
- path/to/file.ts - [what changed]

### Acceptance Criteria Status
- [x] Criterion 1 - PASS
- [x] Criterion 2 - PASS
- [x] Typecheck passes - PASS

### Learnings
- [Patterns discovered]
- [Gotchas encountered]
```

### 7. Close or Fail

**On Success** (all criteria pass):
```bash
bd close $BEAD_ID --reason "Completed: [one-line summary]"
bd sync
```

**On Failure** (any criterion fails):
```bash
bd update $BEAD_ID --notes "FAILURE: [what failed and why]"
bd sync
# Do NOT close failed beads — orchestrator will retry
```

---

## Quality Rules

- ✅ ALL acceptance criteria must pass before closing
- ✅ Typecheck must pass (always required)
- ✅ Keep changes minimal and focused
- ✅ Follow existing code patterns
- ❌ Do NOT commit broken code
- ❌ Do NOT scope-creep beyond this bead
- ❌ Do NOT close if ANY criterion fails

---

## Beads CLI Reference

```bash
bd show <id>                    # View task details
bd update <id> --notes "..."    # Add notes (use for failures)
bd close <id> --reason "..."    # Mark complete (success only)
bd sync                         # Sync state (ALWAYS after changes)
```

---

## Completion Signal

When done (success or failure), output:

```
BEAD_COMPLETE
```

The orchestrator will verify acceptance criteria, merge changes, and handle retries.

## Environment

- Working directory: /Users/admin/clawd/clawdbot-task-viewer/.worktrees/clawdbot-task-viewer-d5q
- Branch: bead/clawdbot-task-viewer-d5q
- Bead ID: clawdbot-task-viewer-d5q
